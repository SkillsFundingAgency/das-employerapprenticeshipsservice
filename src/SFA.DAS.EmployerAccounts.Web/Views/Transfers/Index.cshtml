@using SFA.DAS.Authorization
@using SFA.DAS.Authorization.Mvc
@using SFA.DAS.EmployerAccounts.Web.Extensions
@using SFA.DAS.EmployerAccounts.Web.Helpers
@using SFA.DAS.Common.Domain.Types;
@model TransferAllowanceViewModel
@{
    ViewBag.Title = "Transfers";
    ViewBag.Section = "finance";
    ViewBag.PageID = "page-transfers";
    ViewBag.GaData.Vpv = "/accounts/transfers";
    ViewBag.ZenDeskLabel = "eas-transfers";
    Layout = "~/Views/Shared/_Layout_CDN.cshtml";
}

<h1 class="govuk-heading-xl">Transfers</h1>

@if (ViewBag.ApprenticeshipEmployerType == ApprenticeshipEmployerType.Levy)
{
    @Html.Action("TransferAllowance")
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

        @if (ViewBag.ApprenticeshipEmployerType == ApprenticeshipEmployerType.Levy)
        {
            <p><a href="@Url.EmployerProjectionsAction("forecasting/estimations/start-transfer")" class="govuk-link govuk-link--no-visited-state">Estimate</a> the number of apprentices you can fund with your transfer allowance.</p>
        }

        @Html.Action("TransferConnectionInvitationAuthorization")

        @if (Html.IsAuthorized("EmployerFeature.Transfers"))
        {
            @Html.Action("TransferConnectionInvitations")
            @Html.Action("TransferRequests")
        }
        else
        {
            <p>Before connecting to another employer, both employers will need to:</p>
            <ul class="govuk-list govuk-list--bullet">
                <li>read and understand the <a href="https://www.gov.uk/government/publications/apprenticeship-funding-and-performance-management-rules-2017-to-2018" class="govuk-link" rel="nofollow">rules for sending and receiving transfers</a></li>
                <li>accept the updated ESFA organisation agreement once it's available. View <a href="https://www.gov.uk/government/publications/apprenticeship-funding-legal-agreement-to-enable-spending/guidance-note-on-the-employer-agreement" class="govuk-link" rel="nofollow">guidance on the updated agreement</a> to find out what's changed.</li>
            </ul>
        }
    </div>
</div>

@section breadcrumb {
    <div class="govuk-breadcrumbs">
        <ol class="govuk-breadcrumbs__list">
            <li class="govuk-breadcrumbs__list-item">
                <a class="govuk-breadcrumbs__link" href="@Url.Action("Index", "EmployerTeam")">Home</a>
            </li>
            <li class="govuk-breadcrumbs__list-item">
                <a class="govuk-breadcrumbs__link" href="@Url.EmployerFinanceAction("finance")">Finance</a>
            </li>
            <li class="govuk-breadcrumbs__list-item">
                @ViewBag.Title
            </li>
        </ol>
    </div>
}
